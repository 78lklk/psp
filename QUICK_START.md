# Быстрый запуск системы лояльности

## Шаг 1: Создание базы данных

### Запустите PostgreSQL и выполните:

```sql
-- Подключитесь к PostgreSQL
psql -U postgres -h localhost

-- Создайте базу данных
CREATE DATABASE loyalty_db;

-- Подключитесь к новой базе
\c loyalty_db;

-- Выполните инициализацию (находясь в папке server/src/main/resources/db/)
\i init_full_database.sql;
```

### Или из командной строки:

```bash
# Создание базы данных
createdb -U postgres loyalty_db

# Инициализация данных
psql -U postgres -d loyalty_db -f server/src/main/resources/db/init_full_database.sql
```

## Шаг 2: Настройка подключения

Убедитесь, что в файле `server/src/main/resources/config.properties` указаны правильные настройки:

```properties
db.url=jdbc:postgresql://localhost:5432/loyalty_db
db.user=postgres
db.password=ваш_пароль
```

## Шаг 3: Запуск приложения

### В разных терминалах:

```bash
# Терминал 1: Запуск сервера
./gradlew server:run

# Терминал 2: Запуск клиента (после запуска сервера)
./gradlew client:run
```

## Шаг 4: Вход в систему

### Учетные записи для тестирования:

**Администратор:**

- Логин: `admin`
- Пароль: `admin123`

**Менеджер:**

- Логин: `manager`
- Пароль: `manager123`

**Сотрудник:**

- Логин: `staff1`
- Пароль: `staff123`

**Клиент:**

- Логин: `client1`
- Пароль: `password123`

## Шаг 5: Тестирование функций

После входа в систему вы можете:

1. **Создавать акции** - раздел "Акции и промо-кампании"
2. **Создавать промокоды** - в том же разделе
3. **Просматривать статистику** - все данные реальные из базы
4. **Менять темы** - настройки применяются глобально
5. **Просматривать отчеты** - данные берутся из реальных таблиц

## Возможные проблемы и решения

### Проблема: Порт 8090 занят

```bash
# Найти процесс на порту 8090
netstat -ano | findstr :8090

# Завершить процесс (замените PID на реальный)
taskkill /PID номер_процесса /F
```

### Проблема: Ошибка подключения к БД

1. Убедитесь, что PostgreSQL запущен
2. Проверьте пароль в config.properties
3. Убедитесь, что база данных `loyalty_db` создана

### Проблема: Кодировка

- База данных настроена на UTF-8
- Все русские символы должны отображаться корректно

## Структура данных в БД

После инициализации у вас будет:

- 11 пользователей (админы, менеджеры, сотрудники, клиенты)
- 10 карт клиентов с разными уровнями лояльности
- 5 активных акций
- 7 промокодов (некоторые использованы)
- 10 игровых сессий
- 20 транзакций по баллам
- Системные настройки

## Полезные SQL запросы для проверки

```sql
-- Проверка пользователей
SELECT login, password, full_name FROM users;

-- Проверка карт
SELECT number, points, tier_id FROM cards;

-- Проверка акций
SELECT name, is_active, start_date, end_date FROM promotions;

-- Проверка промокодов
SELECT code, is_used, bonus_points FROM promo_codes;
```
