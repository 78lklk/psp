2025-05-23 00:01:47 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 00:01:47 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 00:01:48 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@69e1dd28
2025-05-23 00:01:48 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 00:01:48 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 00:01:48 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 00:01:48 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: staff2
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: staff2
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=staff2, id=4
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: staff2
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 00:02:10 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь staff2 успешно аутентифицирован
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 00:02:11 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 01:47:15 [main] INFO  server.ServerMain - РРЅРёС†РёР°Р»РёР·Р°С†РёСЏ Р±Р°Р·С‹ РґР°РЅРЅС‹С…...
2025-05-23 01:47:15 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 01:47:16 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@62230c58
2025-05-23 01:47:16 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 01:47:16 [main] INFO  server.db.DatabaseConfig - Р‘Р°Р·Р° РґР°РЅРЅС‹С… СѓСЃРїРµС€РЅРѕ РёРЅРёС†РёР°Р»РёР·РёСЂРѕРІР°РЅР°
2025-05-23 01:47:17 [main] INFO  server.ServerMain - Р—Р°РїСѓСЃРє HTTP СЃРµСЂРІРµСЂР° РЅР° РїРѕСЂС‚Сѓ 8090...
2025-05-23 01:47:17 [main] INFO  server.ServerMain - РЎРµСЂРІРµСЂ Р·Р°РїСѓС‰РµРЅ. РџРѕСЂС‚: 8090
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: POST /api/auth
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - РћР±СЂР°Р±РѕС‚РєР° Р·Р°РїСЂРѕСЃР° РЅР° Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёСЋ
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Р—Р°РїСЂРѕСЃ РЅР° Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёСЋ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ: staff2
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕРїС‹С‚РєР° Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёРё РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ: staff2
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Р’СЃРµРіРѕ РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№ РІ Р±Р°Р·Рµ РґР°РЅРЅС‹С…: 9
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=admin, role=ADMIN, id=1
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=staff2, role=STAFF, id=4
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=staff1, role=STAFF, id=3
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=afsdas, role=CLIENT, id=8
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=sadf, role=CLIENT, id=11
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=sadfafsd, role=CLIENT, id=9
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=admin1, role=CLIENT, id=7
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=client2, role=CLIENT, id=6
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=client1, role=CLIENT, id=5
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=staff2, id=4
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ СѓСЃРїРµС€РЅРѕ Р°СѓС‚РµРЅС‚РёС„РёС†РёСЂРѕРІР°РЅ: staff2
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 01:48:08 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ staff2 СѓСЃРїРµС€РЅРѕ Р°СѓС‚РµРЅС‚РёС„РёС†РёСЂРѕРІР°РЅ
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: GET /api/cards
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - РџРѕР»СѓС‡РµРЅРёРµ РІСЃРµС… РєР°СЂС‚ Р»РѕСЏР»СЊРЅРѕСЃС‚Рё
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 01:48:09 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: POST /api/auth
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.handler.AuthHandler - РћР±СЂР°Р±РѕС‚РєР° Р·Р°РїСЂРѕСЃР° РЅР° Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёСЋ
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.handler.AuthHandler - Р—Р°РїСЂРѕСЃ РЅР° Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёСЋ РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ: admin
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕРїС‹С‚РєР° Р°СѓС‚РµРЅС‚РёС„РёРєР°С†РёРё РїРѕР»СЊР·РѕРІР°С‚РµР»СЏ: admin
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - Р’СЃРµРіРѕ РїРѕР»СЊР·РѕРІР°С‚РµР»РµР№ РІ Р±Р°Р·Рµ РґР°РЅРЅС‹С…: 9
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=admin, role=ADMIN, id=1
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=staff2, role=STAFF, id=4
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=staff1, role=STAFF, id=3
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=afsdas, role=CLIENT, id=8
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=sadf, role=CLIENT, id=11
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=sadfafsd, role=CLIENT, id=9
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=admin1, role=CLIENT, id=7
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=client2, role=CLIENT, id=6
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ РІ Р‘Р”: login=client1, role=CLIENT, id=5
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 01:48:27 [nioEventLoopGroup-3-3] INFO  server.service.UserServiceImpl - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ СѓСЃРїРµС€РЅРѕ Р°СѓС‚РµРЅС‚РёС„РёС†РёСЂРѕРІР°РЅ: admin
2025-05-23 01:48:28 [nioEventLoopGroup-3-3] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 01:48:28 [nioEventLoopGroup-3-3] INFO  server.handler.AuthHandler - РџРѕР»СЊР·РѕРІР°С‚РµР»СЊ admin СѓСЃРїРµС€РЅРѕ Р°СѓС‚РµРЅС‚РёС„РёС†РёСЂРѕРІР°РЅ
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: GET /api/cards
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.service.CardServiceImpl - РџРѕР»СѓС‡РµРЅРёРµ РІСЃРµС… РєР°СЂС‚ Р»РѕСЏР»СЊРЅРѕСЃС‚Рё
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 01:48:28 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: GET /api/statistics/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.service.PromotionServiceImpl - РџРѕР»СѓС‡РµРЅРёРµ РІСЃРµС… Р°РєС†РёР№
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: GET /api/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] DEBUG server.service.PromotionServiceImpl - РџРѕР»СѓС‡РµРЅРёРµ РІСЃРµС… Р°РєС†РёР№
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: GET /api/promo-codes
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] DEBUG server.service.PromoCodeServiceImpl - РџРѕР»СѓС‡РµРЅРёРµ РІСЃРµС… РїСЂРѕРјРѕРєРѕРґРѕРІ
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] DEBUG server.handler.PromotionHandler - Р—Р°РїСЂРѕСЃ РІСЃРµС… Р°РєС†РёР№
2025-05-23 01:48:31 [nioEventLoopGroup-3-5] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 01:48:31 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 01:48:31 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: POST /api/promo-codes
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promo-codes
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/promo-codes
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - Creating new promocode
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] DEBUG server.service.PromoCodeServiceImpl - РЎРѕР·РґР°РЅРёРµ РЅРѕРІРѕРіРѕ РїСЂРѕРјРѕРєРѕРґР°: fsdf
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] ERROR server.service.PromoCodeServiceImpl - РћС€РёР±РєР° РїСЂРё СЃРѕР·РґР°РЅРёРё РїСЂРѕРјРѕРєРѕРґР° РІ Р‘Р”: fsdf
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because the return value of "common.model.PromoCode.getPromotionId()" is null
	at server.db.dao.PromoCodeDaoImpl.insert(PromoCodeDaoImpl.java:158)
	at server.service.PromoCodeServiceImpl.createPromoCode(PromoCodeServiceImpl.java:96)
	at server.handler.PromoCodeHandler.handleCreatePromoCode(PromoCodeHandler.java:199)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:79)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 01:48:43 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: POST /api/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] DEBUG server.handler.PromotionHandler - РЎРѕР·РґР°РЅРёРµ Р°РєС†РёРё: asfasf
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] DEBUG server.service.PromotionServiceImpl - РЎРѕР·РґР°РЅРёРµ РЅРѕРІРѕР№ Р°РєС†РёРё: asfasf
2025-05-23 01:48:54 [nioEventLoopGroup-3-9] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РЅР°Р»РёС‡РёСЏ РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - РџСЂРѕРІРµСЂРєР° РѕР±СЏР·Р°С‚РµР»СЊРЅС‹С… РЅР°СЃС‚СЂРѕРµРє Р·Р°РІРµСЂС€РµРЅР°
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - РџРѕР»СѓС‡РµРЅ Р·Р°РїСЂРѕСЃ: GET /api/statistics/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.service.PromotionServiceImpl - РџРѕР»СѓС‡РµРЅРёРµ РІСЃРµС… Р°РєС†РёР№
2025-05-23 01:48:54 [nioEventLoopGroup-3-10] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 02:05:34 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 02:05:34 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 02:05:35 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 02:05:35 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 02:05:35 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 02:05:35 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 02:05:36 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 02:06:00 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 02:06:01 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/users
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/users
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Handling GET all users request
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Getting all users from service
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - Получение всех пользователей
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Retrieved 9 users from database
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Sending response with 9 users
2025-05-23 02:06:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Sent success response
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 02:06:13 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 02:06:13 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:06:13 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promo-codes/1
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promo-codes/1
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/1
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: PUT /api/promo-codes/1
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Updating promocode with id: 1
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.service.PromoCodeServiceImpl - Обновление промокода с ID: 1
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 1
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] ERROR server.service.PromoCodeServiceImpl - Ошибка при обновлении промокода с ID: 1
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because the return value of "common.model.PromoCode.getPromotionId()" is null
	at server.db.dao.PromoCodeDaoImpl.update(PromoCodeDaoImpl.java:197)
	at server.service.PromoCodeServiceImpl.updatePromoCode(PromoCodeServiceImpl.java:130)
	at server.handler.PromoCodeHandler.handleUpdatePromoCode(PromoCodeHandler.java:221)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:94)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 02:07:13 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Sent error response: 404 Not Found, {"success":false,"data":null,"errorMessage":"Promocode not found","errorCode":"ERROR"}
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/promo-codes
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promo-codes
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/promo-codes
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - Creating new promocode
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] DEBUG server.service.PromoCodeServiceImpl - Создание нового промокода: ыаыв
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] ERROR server.service.PromoCodeServiceImpl - Ошибка при создании промокода в БД: ыаыв
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because the return value of "common.model.PromoCode.getPromotionId()" is null
	at server.db.dao.PromoCodeDaoImpl.insert(PromoCodeDaoImpl.java:158)
	at server.service.PromoCodeServiceImpl.createPromoCode(PromoCodeServiceImpl.java:96)
	at server.handler.PromoCodeHandler.handleCreatePromoCode(PromoCodeHandler.java:199)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:79)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 02:07:41 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: DELETE /api/promo-codes/1
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - UserHandler processing request: DELETE /api/promo-codes/1
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/1
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: DELETE /api/promo-codes/1
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - Deleting promocode with id: 1
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 1
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.service.PromoCodeServiceImpl - Удаление промокода с ID: 1
2025-05-23 02:07:55 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:07:55 [nioEventLoopGroup-3-10] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promotions/4
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promotions/4
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions/4
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] DEBUG server.handler.PromotionHandler - Обновление акции с ID: 4
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] DEBUG server.service.PromotionServiceImpl - Получение акции по ID: 4
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] DEBUG server.service.PromotionServiceImpl - Обновление акции с ID 4: фвафва
2025-05-23 02:08:05 [nioEventLoopGroup-3-11] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:08:05 [nioEventLoopGroup-3-12] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: manager
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: manager
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.db.dao.UserDaoImpl - No user found for login=manager and provided password
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Неверный логин или пароль для пользователя: manager
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] DEBUG server.handler.AuthHandler - Sent error response: 401 Unauthorized, Неверный логин или пароль
2025-05-23 02:09:50 [nioEventLoopGroup-3-13] WARN  server.handler.AuthHandler - Ошибка аутентификации пользователя manager: Неверный логин или пароль
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: staff2
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: staff2
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.db.dao.UserDaoImpl - User found: login=staff2, id=4
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: staff2
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 02:10:11 [nioEventLoopGroup-3-14] INFO  server.handler.AuthHandler - Пользователь staff2 успешно аутентифицирован
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 02:10:11 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 02:13:20 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 02:13:20 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 02:13:21 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 02:13:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 02:13:21 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 02:13:21 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 02:13:21 [main] INFO  server.ServerMain - Завершение работы сервера...
2025-05-23 02:13:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Shutdown initiated...
2025-05-23 02:13:21 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Shutdown completed.
2025-05-23 02:13:21 [main] INFO  server.db.DatabaseConfig - Пул соединений с базой данных закрыт
2025-05-23 02:13:21 [main] INFO  server.ServerMain - Сервер остановлен
2025-05-23 02:13:21 [main] ERROR server.ServerMain - Ошибка при запуске сервера
java.net.BindException: Address already in use: bind
	at java.base/sun.nio.ch.Net.bind0(Native Method)
	at java.base/sun.nio.ch.Net.bind(Net.java:565)
	at java.base/sun.nio.ch.ServerSocketChannelImpl.netBind(ServerSocketChannelImpl.java:344)
	at java.base/sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:301)
	at io.netty.channel.socket.nio.NioServerSocketChannel.doBind(NioServerSocketChannel.java:141)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.bind(AbstractChannel.java:562)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.bind(DefaultChannelPipeline.java:1334)
	at io.netty.channel.AbstractChannelHandlerContext.invokeBind(AbstractChannelHandlerContext.java:600)
	at io.netty.channel.AbstractChannelHandlerContext.bind(AbstractChannelHandlerContext.java:579)
	at io.netty.channel.DefaultChannelPipeline.bind(DefaultChannelPipeline.java:973)
	at io.netty.channel.AbstractChannel.bind(AbstractChannel.java:260)
	at io.netty.bootstrap.AbstractBootstrap$2.run(AbstractBootstrap.java:356)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 02:24:55 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 02:24:56 [nioEventLoopGroup-3-16] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 02:24:57 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:24:57 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:24:57 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:24:57 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:24:57 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 02:24:57 [nioEventLoopGroup-3-1] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 02:24:57 [nioEventLoopGroup-3-1] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 02:24:58 [nioEventLoopGroup-3-1] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 02:24:58 [nioEventLoopGroup-3-1] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 02:24:58 [nioEventLoopGroup-3-1] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 02:24:58 [nioEventLoopGroup-3-1] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 02:24:58 [nioEventLoopGroup-3-1] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/users
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/users
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Handling GET all users request
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Getting all users from service
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.service.UserServiceImpl - Получение всех пользователей
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Retrieved 9 users from database
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Sending response with 9 users
2025-05-23 02:25:00 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Sent success response
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 02:25:04 [nioEventLoopGroup-3-3] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 02:25:04 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 02:25:04 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 02:25:14 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 02:25:19 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 02:25:23 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 02:25:59 [nioEventLoopGroup-3-9] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/users
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/users
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Handling GET all users request
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Getting all users from service
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.service.UserServiceImpl - Получение всех пользователей
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Retrieved 9 users from database
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Sending response with 9 users
2025-05-23 02:26:06 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Sent success response
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:26:19 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:26:19 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:26:19 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:26:19 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:26:19 [nioEventLoopGroup-3-11] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 02:26:20 [nioEventLoopGroup-3-11] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 02:26:20 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 02:26:20 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 02:26:20 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:26:20 [nioEventLoopGroup-3-12] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 02:26:20 [nioEventLoopGroup-3-12] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 02:26:20 [nioEventLoopGroup-3-12] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:26:20 [nioEventLoopGroup-3-12] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 02:26:20 [nioEventLoopGroup-3-13] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promo-codes/2
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promo-codes/2
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/2
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: PUT /api/promo-codes/2
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.handler.PromoCodeHandler - Updating promocode with id: 2
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.service.PromoCodeServiceImpl - Обновление промокода с ID: 2
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 2
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] ERROR server.service.PromoCodeServiceImpl - Ошибка при обновлении промокода с ID: 2
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because the return value of "common.model.PromoCode.getPromotionId()" is null
	at server.db.dao.PromoCodeDaoImpl.update(PromoCodeDaoImpl.java:197)
	at server.service.PromoCodeServiceImpl.updatePromoCode(PromoCodeServiceImpl.java:130)
	at server.handler.PromoCodeHandler.handleUpdatePromoCode(PromoCodeHandler.java:221)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:94)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 02:26:31 [nioEventLoopGroup-3-14] DEBUG server.handler.PromoCodeHandler - Sent error response: 404 Not Found, {"success":false,"data":null,"errorMessage":"Promocode not found","errorCode":"ERROR"}
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/promo-codes
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promo-codes
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/promo-codes
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] DEBUG server.handler.PromoCodeHandler - Creating new promocode
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] DEBUG server.service.PromoCodeServiceImpl - Создание нового промокода: фафыа
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] ERROR server.service.PromoCodeServiceImpl - Ошибка при создании промокода в БД: фафыа
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because the return value of "common.model.PromoCode.getPromotionId()" is null
	at server.db.dao.PromoCodeDaoImpl.insert(PromoCodeDaoImpl.java:158)
	at server.service.PromoCodeServiceImpl.createPromoCode(PromoCodeServiceImpl.java:96)
	at server.handler.PromoCodeHandler.handleCreatePromoCode(PromoCodeHandler.java:199)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:79)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 02:27:07 [nioEventLoopGroup-3-15] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 02:35:38 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 02:35:38 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 02:35:39 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 02:35:39 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 02:35:39 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 02:35:39 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 02:35:39 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 02:56:45 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 02:56:45 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 02:56:46 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 02:56:46 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 02:56:46 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 02:56:46 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 02:56:46 [main] INFO  server.ServerMain - Завершение работы сервера...
2025-05-23 02:56:47 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Shutdown initiated...
2025-05-23 02:56:47 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Shutdown completed.
2025-05-23 02:56:47 [main] INFO  server.db.DatabaseConfig - Пул соединений с базой данных закрыт
2025-05-23 02:56:47 [main] INFO  server.ServerMain - Сервер остановлен
2025-05-23 02:56:47 [main] ERROR server.ServerMain - Ошибка при запуске сервера
java.net.BindException: Address already in use: bind
	at java.base/sun.nio.ch.Net.bind0(Native Method)
	at java.base/sun.nio.ch.Net.bind(Net.java:565)
	at java.base/sun.nio.ch.ServerSocketChannelImpl.netBind(ServerSocketChannelImpl.java:344)
	at java.base/sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:301)
	at io.netty.channel.socket.nio.NioServerSocketChannel.doBind(NioServerSocketChannel.java:141)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.bind(AbstractChannel.java:562)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.bind(DefaultChannelPipeline.java:1334)
	at io.netty.channel.AbstractChannelHandlerContext.invokeBind(AbstractChannelHandlerContext.java:600)
	at io.netty.channel.AbstractChannelHandlerContext.bind(AbstractChannelHandlerContext.java:579)
	at io.netty.channel.DefaultChannelPipeline.bind(DefaultChannelPipeline.java:973)
	at io.netty.channel.AbstractChannel.bind(AbstractChannel.java:260)
	at io.netty.bootstrap.AbstractBootstrap$2.run(AbstractBootstrap.java:356)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:569)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 03:00:59 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 03:01:00 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 03:03:03 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 03:03:03 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 03:03:04 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 03:03:04 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 03:03:04 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 03:03:04 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 03:03:04 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 03:03:22 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 03:06:37 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 03:06:37 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 03:06:39 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@59af0466
2025-05-23 03:06:39 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 03:06:39 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 03:06:39 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 03:06:39 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadf, role=CLIENT, id=11
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 03:06:51 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 7 cards from database
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 7 cards
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:06:52 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:06:52 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 7 cards to client
2025-05-23 03:07:22 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:07:22 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:07:22 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:07:22 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:07:22 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:07:22 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:07:22 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:07:22 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:07:22 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/cards/6/add
2025-05-23 03:07:22 [nioEventLoopGroup-3-5] DEBUG server.handler.CardHandler - Processing request: POST /api/cards/6/add
2025-05-23 03:07:23 [nioEventLoopGroup-3-5] DEBUG server.service.CardServiceImpl - Начисление 1 баллов на карту 6
2025-05-23 03:07:23 [nioEventLoopGroup-3-5] INFO  server.service.CardServiceImpl - На карту 6559441260275736 начислено 1 баллов. Текущий баланс: 51
2025-05-23 03:07:23 [nioEventLoopGroup-3-5] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/cards
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.handler.CardHandler - Processing request: POST /api/cards
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.handler.CardHandler - Received request to create card with number CC49850197 for user 1
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Создание новой карты лояльности с номером CC49850197 для пользователя 1
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Карта с номером CC49850197 не найдена, можно создать
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Пользователь с id 1 найден: admin
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Ищем базовый уровень лояльности для 0 баллов
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Найдено 5 уровней лояльности
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Уровень: level=1, name=Р‘СЂРѕРЅР·РѕРІС‹Р№, minPoints=0
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Уровень: level=2, name=РЎРµСЂРµР±СЂСЏРЅС‹Р№, minPoints=100
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Уровень: level=3, name=Р—РѕР»РѕС‚РѕР№, minPoints=500
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Уровень: level=4, name=РџР»Р°С‚РёРЅРѕРІС‹Р№, minPoints=1000
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Уровень: level=5, name=VIP, minPoints=2000
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Базовый уровень лояльности найден: Р‘СЂРѕРЅР·РѕРІС‹Р№
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.service.CardServiceImpl - Сохраняем карту: номер=CC49850197, пользователь=1, уровень=Р‘СЂРѕРЅР·РѕРІС‹Р№
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] INFO  server.service.CardServiceImpl - Создана новая карта лояльности: CC49850197
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.handler.CardHandler - Card created successfully: CC49850197
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:07:54 [nioEventLoopGroup-3-6] DEBUG server.handler.CardHandler - Successfully sent created card response to client
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.handler.CardHandler - Retrieved 8 cards from database
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.handler.CardHandler - Sending success response with 8 cards
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:07:57 [nioEventLoopGroup-3-7] DEBUG server.handler.CardHandler - Successfully sent 8 cards to client
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Retrieved 8 cards from database
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Sending success response with 8 cards
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:07:58 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Successfully sent 8 cards to client
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/cards
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Processing request: POST /api/cards
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Received request to create card with number CC64794434 for user 1
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Создание новой карты лояльности с номером CC64794434 для пользователя 1
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Карта с номером CC64794434 не найдена, можно создать
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Пользователь с id 1 найден: admin
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Ищем базовый уровень лояльности для 0 баллов
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Найдено 5 уровней лояльности
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Уровень: level=1, name=Р‘СЂРѕРЅР·РѕРІС‹Р№, minPoints=0
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Уровень: level=2, name=РЎРµСЂРµР±СЂСЏРЅС‹Р№, minPoints=100
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Уровень: level=3, name=Р—РѕР»РѕС‚РѕР№, minPoints=500
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Уровень: level=4, name=РџР»Р°С‚РёРЅРѕРІС‹Р№, minPoints=1000
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Уровень: level=5, name=VIP, minPoints=2000
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Базовый уровень лояльности найден: Р‘СЂРѕРЅР·РѕРІС‹Р№
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Сохраняем карту: номер=CC64794434, пользователь=1, уровень=Р‘СЂРѕРЅР·РѕРІС‹Р№
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] INFO  server.service.CardServiceImpl - Создана новая карта лояльности: CC64794434
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Card created successfully: CC64794434
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:08:02 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Successfully sent created card response to client
2025-05-23 03:08:16 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:16 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:16 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:16 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/cards/6/deduct
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Processing request: POST /api/cards/6/deduct
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] DEBUG server.service.CardServiceImpl - Списание 1 баллов с карты 6
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] INFO  server.service.CardServiceImpl - С карты 6559441260275736 списано 1 баллов. Текущий баланс: 50
2025-05-23 03:08:16 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/users
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/users
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Handling GET all users request
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Getting all users from service
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.service.UserServiceImpl - Получение всех пользователей
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Retrieved 9 users from database
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Sending response with 9 users
2025-05-23 03:08:18 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Sent success response
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/users/11
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/users/11
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - Updating user with ID: 11
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Получение пользователя по id: 11
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - Setting fullName: sadf asdfsadf
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Обновление пользователя: 11
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] INFO  server.service.UserServiceImpl - Пользователь обновлен: sadfй
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - User updated successfully
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.service.UserServiceImpl - Получение пользователя по id: 11
2025-05-23 03:08:24 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - Sent success response with charset: UTF-8
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 11
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/REPORTS_DIR
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/REPORTS_DIR
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: REPORTS_DIR
2025-05-23 03:08:37 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Отправлена настройка: REPORTS_DIR
2025-05-23 03:08:37 [nioEventLoopGroup-3-14] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 11
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/THEME
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/THEME
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: THEME
2025-05-23 03:08:37 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Отправлена настройка: THEME
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:08:37 [nioEventLoopGroup-3-16] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/THEME
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/THEME
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: THEME
2025-05-23 03:08:47 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-14] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-14] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/REPORTS_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/REPORTS_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Отправлена настройка: THEME
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: REPORTS_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-14] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Отправлена настройка: REPORTS_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/settings
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: POST /api/settings
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Получено тело запроса для сохранения настройки: {"key":"BACKUP_DIR","value":"backups","description":"Директория для хранения резервных копий","lastUpdated":[2025,5,23,3,8,47,429092900],"updatedBy":null,"login":null}
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Десериализованная настройка: ключ=BACKUP_DIR, значение=backups, описание=Директория для хранения резервных копий
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/settings
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: POST /api/settings
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Получено тело запроса для сохранения настройки: {"key":"THEME","value":"SYSTEM","description":"Тема оформления приложения","lastUpdated":[2025,5,23,3,8,47,456339400],"updatedBy":null,"login":null}
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Настройка сохранена в базу данных: BACKUP_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - Настройка успешно сохранена: BACKUP_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Десериализованная настройка: ключ=THEME, значение=SYSTEM, описание=Тема оформления приложения
2025-05-23 03:08:47 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Sent success response
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.service.SettingsServiceImpl - Настройка сохранена в базу данных: THEME
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] INFO  server.handler.SettingsHandler - Настройка успешно сохранена: THEME
2025-05-23 03:08:47 [nioEventLoopGroup-3-15] DEBUG server.handler.SettingsHandler - Sent success response
2025-05-23 03:08:47 [nioEventLoopGroup-3-16] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/settings
2025-05-23 03:08:47 [nioEventLoopGroup-3-16] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: POST /api/settings
2025-05-23 03:08:47 [nioEventLoopGroup-3-16] DEBUG server.handler.SettingsHandler - Получено тело запроса для сохранения настройки: {"key":"REPORTS_DIR","value":"reports","description":"Директория для хранения отчетов","lastUpdated":[2025,5,23,3,8,47,431092300],"updatedBy":null,"login":null}
2025-05-23 03:08:47 [nioEventLoopGroup-3-16] DEBUG server.handler.SettingsHandler - Десериализованная настройка: ключ=REPORTS_DIR, значение=reports, описание=Директория для хранения отчетов
2025-05-23 03:08:47 [nioEventLoopGroup-3-16] DEBUG server.service.SettingsServiceImpl - Настройка сохранена в базу данных: REPORTS_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-16] INFO  server.handler.SettingsHandler - Настройка успешно сохранена: REPORTS_DIR
2025-05-23 03:08:47 [nioEventLoopGroup-3-16] DEBUG server.handler.SettingsHandler - Sent success response
2025-05-23 03:08:48 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:08:48 [nioEventLoopGroup-3-14] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:08:48 [nioEventLoopGroup-3-14] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 11
2025-05-23 03:08:48 [nioEventLoopGroup-3-14] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 11
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:09:13 [nioEventLoopGroup-3-2] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:09:13 [nioEventLoopGroup-3-3] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 03:09:13 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/REPORTS_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/REPORTS_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 11
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: REPORTS_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-8] DEBUG server.handler.SettingsHandler - Отправлена настройка: REPORTS_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 11
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/THEME
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/THEME
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: THEME
2025-05-23 03:09:22 [nioEventLoopGroup-3-7] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:09:22 [nioEventLoopGroup-3-6] DEBUG server.handler.SettingsHandler - Отправлена настройка: THEME
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: staff2
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: staff2
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.db.dao.UserDaoImpl - User found: login=staff2, id=4
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: staff2
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 03:10:31 [nioEventLoopGroup-3-9] INFO  server.handler.AuthHandler - Пользователь staff2 успешно аутентифицирован
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.handler.CardHandler - Retrieved 9 cards from database
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.handler.CardHandler - Sending success response with 9 cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:10:31 [nioEventLoopGroup-3-10] DEBUG server.handler.CardHandler - Successfully sent 9 cards to client
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Retrieved 9 cards from database
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Sending success response with 9 cards
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:10:31 [nioEventLoopGroup-3-11] DEBUG server.handler.CardHandler - Successfully sent 9 cards to client
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.handler.CardHandler - Retrieved 9 cards from database
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.handler.CardHandler - Sending success response with 9 cards
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:10:34 [nioEventLoopGroup-3-12] DEBUG server.handler.CardHandler - Successfully sent 9 cards to client
2025-05-23 03:14:11 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 03:14:11 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 03:14:13 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@55536d9e
2025-05-23 03:14:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 03:14:13 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 03:14:13 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 03:14:14 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 03:14:27 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 9 cards from database
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 9 cards from database
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 9 cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 9 cards
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:14:28 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 9 cards to client
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:14:28 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 9 cards to client
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/THEME
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/THEME
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: THEME
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/REPORTS_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/REPORTS_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: REPORTS_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 11
2025-05-23 03:14:31 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Отправлена настройка: THEME
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-7] DEBUG server.handler.SettingsHandler - Отправлена настройка: REPORTS_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-6] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:14:31 [nioEventLoopGroup-3-4] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 11
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/cards
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Processing request: POST /api/cards
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Received request to create card with number CC93911081 for user 1
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Создание новой карты лояльности с номером CC93911081 для пользователя 1
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Карта с номером CC93911081 не найдена, можно создать
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Пользователь с id 1 найден: admin
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Ищем базовый уровень лояльности для 0 баллов
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Найдено 5 уровней лояльности
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Уровень: level=1, name=Р‘СЂРѕРЅР·РѕРІС‹Р№, minPoints=0
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Уровень: level=2, name=РЎРµСЂРµР±СЂСЏРЅС‹Р№, minPoints=100
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Уровень: level=3, name=Р—РѕР»РѕС‚РѕР№, minPoints=500
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Уровень: level=4, name=РџР»Р°С‚РёРЅРѕРІС‹Р№, minPoints=1000
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Уровень: level=5, name=VIP, minPoints=2000
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Базовый уровень лояльности найден: Р‘СЂРѕРЅР·РѕРІС‹Р№
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.service.CardServiceImpl - Сохраняем карту: номер=CC93911081, пользователь=1, уровень=Р‘СЂРѕРЅР·РѕРІС‹Р№
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] INFO  server.service.CardServiceImpl - Создана новая карта лояльности: CC93911081
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Card created successfully: CC93911081
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:14:37 [nioEventLoopGroup-3-8] DEBUG server.handler.CardHandler - Successfully sent created card response to client
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:14:40 [nioEventLoopGroup-3-9] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:42 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:42 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:42 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:14:42 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:42 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 11
2025-05-23 03:14:42 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:14:42 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:14:42 [nioEventLoopGroup-3-12] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:14:42 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:42 [nioEventLoopGroup-3-13] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-13] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:42 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 11
2025-05-23 03:14:42 [nioEventLoopGroup-3-13] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/REPORTS_DIR
2025-05-23 03:14:43 [nioEventLoopGroup-3-13] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/REPORTS_DIR
2025-05-23 03:14:43 [nioEventLoopGroup-3-13] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: REPORTS_DIR
2025-05-23 03:14:43 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:14:43 [nioEventLoopGroup-3-13] DEBUG server.handler.SettingsHandler - Отправлена настройка: REPORTS_DIR
2025-05-23 03:14:43 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/THEME
2025-05-23 03:14:43 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/THEME
2025-05-23 03:14:43 [nioEventLoopGroup-3-11] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: THEME
2025-05-23 03:14:43 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Отправлена настройка: THEME
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:14:45 [nioEventLoopGroup-3-14] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:14:45 [nioEventLoopGroup-3-15] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 03:14:45 [nioEventLoopGroup-3-16] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:14:48 [nioEventLoopGroup-3-1] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promo-codes/2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promo-codes/2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: PUT /api/promo-codes/2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.handler.PromoCodeHandler - Updating promocode with id: 2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.service.PromoCodeServiceImpl - Обновление промокода с ID: 2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при обновлении промокода с ID: 2
org.postgresql.util.PSQLException: ERROR: column "used_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 78
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.update(PromoCodeDaoImpl.java:205)
	at server.service.PromoCodeServiceImpl.updatePromoCode(PromoCodeServiceImpl.java:130)
	at server.handler.PromoCodeHandler.handleUpdatePromoCode(PromoCodeHandler.java:221)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:94)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] WARN  server.service.PromoCodeServiceImpl - Не удалось обновить промокод с ID: 2
2025-05-23 03:14:57 [nioEventLoopGroup-3-2] DEBUG server.handler.PromoCodeHandler - Sent error response: 404 Not Found, {"success":false,"data":null,"errorMessage":"Promocode not found","errorCode":"ERROR"}
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:15:17 [nioEventLoopGroup-3-3] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/promo-codes
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promo-codes
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/promo-codes
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] DEBUG server.handler.PromoCodeHandler - Creating new promocode
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] DEBUG server.service.PromoCodeServiceImpl - Создание нового промокода: sadf
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при создании промокода
org.postgresql.util.PSQLException: ERROR: column "used_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 120
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.insert(PromoCodeDaoImpl.java:165)
	at server.service.PromoCodeServiceImpl.createPromoCode(PromoCodeServiceImpl.java:96)
	at server.handler.PromoCodeHandler.handleCreatePromoCode(PromoCodeHandler.java:199)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:79)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] ERROR server.service.PromoCodeServiceImpl - Не удалось создать промокод в БД: sadf
2025-05-23 03:15:24 [nioEventLoopGroup-3-4] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/backup
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/backup
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/backup
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/backup
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/backup
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] DEBUG server.handler.ReportHandler - ReportHandler processing: GET /api/backup
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] WARN  server.handler.HttpServerHandler - Не найден обработчик для запроса: GET /api/backup
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:15:48 [nioEventLoopGroup-3-6] DEBUG server.handler.AuthHandler - Sent error response: 404 Not Found, Ресурс не найден
2025-05-23 03:15:48 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/backup
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/backup
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/backup
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/backup
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: POST /api/backup
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] DEBUG server.handler.ReportHandler - ReportHandler processing: POST /api/backup
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] WARN  server.handler.HttpServerHandler - Не найден обработчик для запроса: POST /api/backup
2025-05-23 03:15:49 [nioEventLoopGroup-3-7] DEBUG server.handler.AuthHandler - Sent error response: 404 Not Found, Ресурс не найден
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/backup
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/backup
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/backup
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/backup
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: POST /api/backup
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] DEBUG server.handler.ReportHandler - ReportHandler processing: POST /api/backup
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] WARN  server.handler.HttpServerHandler - Не найден обработчик для запроса: POST /api/backup
2025-05-23 03:15:54 [nioEventLoopGroup-3-8] DEBUG server.handler.AuthHandler - Sent error response: 404 Not Found, Ресурс не найден
2025-05-23 03:15:58 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:15:58 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:58 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/THEME
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/THEME
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: THEME
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:15:58 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Отправлена настройка: THEME
2025-05-23 03:15:58 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/REPORTS_DIR
2025-05-23 03:15:58 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/REPORTS_DIR
2025-05-23 03:15:58 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: REPORTS_DIR
2025-05-23 03:15:58 [nioEventLoopGroup-3-9] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 11
2025-05-23 03:15:58 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Отправлена настройка: REPORTS_DIR
2025-05-23 03:15:59 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 11
2025-05-23 03:16:03 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: POST /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Получено тело запроса для сохранения настройки: {"key":"THEME","value":"SYSTEM","description":"Тема интерфейса","lastUpdated":[2025,5,23,3,16,3,762467100],"updatedBy":null,"login":null}
2025-05-23 03:16:03 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Десериализованная настройка: ключ=THEME, значение=SYSTEM, описание=Тема интерфейса
2025-05-23 03:16:03 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: POST /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Получено тело запроса для сохранения настройки: {"key":"BACKUP_DIR","value":"backups","description":"Директория для резервных копий","lastUpdated":[2025,5,23,3,16,3,769224200],"updatedBy":null,"login":null}
2025-05-23 03:16:03 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Десериализованная настройка: ключ=BACKUP_DIR, значение=backups, описание=Директория для резервных копий
2025-05-23 03:16:03 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: POST /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Получено тело запроса для сохранения настройки: {"key":"REPORTS_DIR","value":"reports","description":"Директория для отчетов","lastUpdated":[2025,5,23,3,16,3,772229000],"updatedBy":null,"login":null}
2025-05-23 03:16:03 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Десериализованная настройка: ключ=REPORTS_DIR, значение=reports, описание=Директория для отчетов
2025-05-23 03:16:03 [nioEventLoopGroup-3-10] DEBUG server.service.SettingsServiceImpl - Настройка сохранена в базу данных: THEME
2025-05-23 03:16:03 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - Настройка успешно сохранена: THEME
2025-05-23 03:16:03 [nioEventLoopGroup-3-11] DEBUG server.service.SettingsServiceImpl - Настройка сохранена в базу данных: BACKUP_DIR
2025-05-23 03:16:03 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - Настройка успешно сохранена: BACKUP_DIR
2025-05-23 03:16:03 [nioEventLoopGroup-3-10] DEBUG server.handler.SettingsHandler - Sent success response
2025-05-23 03:16:03 [nioEventLoopGroup-3-11] DEBUG server.handler.SettingsHandler - Sent success response
2025-05-23 03:16:03 [nioEventLoopGroup-3-12] DEBUG server.service.SettingsServiceImpl - Настройка сохранена в базу данных: REPORTS_DIR
2025-05-23 03:16:03 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - Настройка успешно сохранена: REPORTS_DIR
2025-05-23 03:16:03 [nioEventLoopGroup-3-12] DEBUG server.handler.SettingsHandler - Sent success response
2025-05-23 03:16:03 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:16:03 [nioEventLoopGroup-3-9] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 11
2025-05-23 03:16:03 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 11
2025-05-23 03:16:09 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/settings
2025-05-23 03:16:09 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: POST /api/settings
2025-05-23 03:16:09 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Получено тело запроса для сохранения настройки: {"key":"asd","value":"asd","description":"1","lastUpdated":[2025,5,23,3,16,9,121768200],"updatedBy":null,"login":null}
2025-05-23 03:16:09 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Десериализованная настройка: ключ=asd, значение=asd, описание=1
2025-05-23 03:16:09 [nioEventLoopGroup-3-9] DEBUG server.service.SettingsServiceImpl - Настройка сохранена в базу данных: asd
2025-05-23 03:16:09 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - Настройка успешно сохранена: asd
2025-05-23 03:16:09 [nioEventLoopGroup-3-9] DEBUG server.handler.SettingsHandler - Sent success response
2025-05-23 03:18:51 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 03:18:51 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 03:18:52 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@4d910fd6
2025-05-23 03:18:52 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 03:18:52 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 03:18:53 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 03:18:53 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 03:19:02 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 03:19:03 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:19:04 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:19:04 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/users
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/users
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Handling GET all users request
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Getting all users from service
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.service.UserServiceImpl - Получение всех пользователей
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Retrieved 9 users from database
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Sending response with 9 users
2025-05-23 03:19:07 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Sent success response
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:19:11 [nioEventLoopGroup-3-5] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:19:11 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 03:19:11 [nioEventLoopGroup-3-7] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 03:19:51 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:51 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:51 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:19:52 [nioEventLoopGroup-3-10] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 03:19:52 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:19:52 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:19:55 [nioEventLoopGroup-3-11] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promo-codes/2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promo-codes/2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: PUT /api/promo-codes/2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.handler.PromoCodeHandler - Updating promocode with id: 2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.service.PromoCodeServiceImpl - Обновление промокода с ID: 2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при обновлении промокода с ID: 2
org.postgresql.util.PSQLException: ERROR: column "created_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 129
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.update(PromoCodeDaoImpl.java:231)
	at server.service.PromoCodeServiceImpl.updatePromoCode(PromoCodeServiceImpl.java:130)
	at server.handler.PromoCodeHandler.handleUpdatePromoCode(PromoCodeHandler.java:221)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:94)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] WARN  server.service.PromoCodeServiceImpl - Не удалось обновить промокод с ID: 2
2025-05-23 03:20:00 [nioEventLoopGroup-3-12] DEBUG server.handler.PromoCodeHandler - Sent error response: 404 Not Found, {"success":false,"data":null,"errorMessage":"Promocode not found","errorCode":"ERROR"}
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:20:21 [nioEventLoopGroup-3-13] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promo-codes/2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promo-codes/2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: PUT /api/promo-codes/2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.handler.PromoCodeHandler - Updating promocode with id: 2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.service.PromoCodeServiceImpl - Обновление промокода с ID: 2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при обновлении промокода с ID: 2
org.postgresql.util.PSQLException: ERROR: column "created_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 129
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.update(PromoCodeDaoImpl.java:231)
	at server.service.PromoCodeServiceImpl.updatePromoCode(PromoCodeServiceImpl.java:130)
	at server.handler.PromoCodeHandler.handleUpdatePromoCode(PromoCodeHandler.java:221)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:94)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] WARN  server.service.PromoCodeServiceImpl - Не удалось обновить промокод с ID: 2
2025-05-23 03:20:26 [nioEventLoopGroup-3-14] DEBUG server.handler.PromoCodeHandler - Sent error response: 404 Not Found, {"success":false,"data":null,"errorMessage":"Promocode not found","errorCode":"ERROR"}
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 03:20:36 [nioEventLoopGroup-3-15] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/promo-codes
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promo-codes
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/promo-codes
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.handler.PromoCodeHandler - Creating new promocode
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.service.PromoCodeServiceImpl - Создание нового промокода: ыфа
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при создании промокода
org.postgresql.util.PSQLException: ERROR: column "created_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 132
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.insert(PromoCodeDaoImpl.java:178)
	at server.service.PromoCodeServiceImpl.createPromoCode(PromoCodeServiceImpl.java:96)
	at server.handler.PromoCodeHandler.handleCreatePromoCode(PromoCodeHandler.java:199)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:79)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] ERROR server.service.PromoCodeServiceImpl - Не удалось создать промокод в БД: ыфа
2025-05-23 03:20:41 [nioEventLoopGroup-3-16] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/THEME
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/THEME
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: THEME
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/REPORTS_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/REPORTS_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: REPORTS_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Получены все настройки из базы данных. Количество: 12
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-4] DEBUG server.handler.SettingsHandler - Отправлена настройка: REPORTS_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-3] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:21:39 [nioEventLoopGroup-3-2] DEBUG server.handler.SettingsHandler - Отправлена настройка: THEME
2025-05-23 03:21:39 [nioEventLoopGroup-3-1] DEBUG server.handler.SettingsHandler - Отправлены все настройки. Количество: 12
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/settings/BACKUP_DIR
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/backup
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Обработка запроса к настройкам: GET /api/settings/BACKUP_DIR
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/backup
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/backup
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: BACKUP_DIR
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/backup
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/backup
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.ReportHandler - ReportHandler processing: GET /api/backup
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.BackupHandler - BackupHandler processing: GET /api/backup
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.BackupHandler - Getting all backups
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.service.BackupServiceImpl - Запрос всех резервных копий (0)
2025-05-23 03:21:53 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - Отправлена настройка: BACKUP_DIR
2025-05-23 03:21:53 [nioEventLoopGroup-3-6] DEBUG server.handler.BackupHandler - Sent success response
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: POST /api/backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.ReportHandler - ReportHandler processing: POST /api/backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.BackupHandler - BackupHandler processing: POST /api/backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.BackupHandler - Creating new backup
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.handler.BackupHandler - Request body: {}
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.UserServiceImpl - Получение пользователя по id: 1
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.BackupServiceImpl - Создание резервной копии пользователем: admin
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: db.host
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: db.port
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: db.name
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: db.user
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: db.password
2025-05-23 03:21:54 [nioEventLoopGroup-3-7] INFO  server.service.BackupServiceImpl - Создание дампа базы данных: postgres@localhost:5432/loyalty_db
2025-05-23 03:25:51 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 03:25:51 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 03:25:52 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@73ee04c8
2025-05-23 03:25:52 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 03:25:52 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 03:25:52 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 03:25:52 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 03:27:52 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 03:27:53 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:27:55 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:27:55 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:27:56 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 03:27:56 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 03:27:56 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:27:56 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 03:27:56 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 03:33:56 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 03:33:56 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 03:33:57 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@10959ece
2025-05-23 03:33:57 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 03:33:57 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 03:33:57 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 03:33:57 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 06:28:55 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 06:28:55 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 06:28:56 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@4d910fd6
2025-05-23 06:28:56 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 06:28:56 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 06:28:57 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 06:28:57 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 06:30:27 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 06:30:27 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 06:30:28 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@3246fb96
2025-05-23 06:30:28 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 06:30:28 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 06:30:29 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 06:30:29 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 06:30:52 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 06:30:52 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 06:30:52 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 06:30:52 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 06:30:53 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 06:30:54 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 06:30:54 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 06:30:54 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 06:30:54 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 06:30:54 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 06:30:54 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 06:30:54 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 06:30:54 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 06:30:55 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 06:30:55 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 06:30:55 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 06:30:55 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 06:30:55 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 08:26:34 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 08:26:38 [nioEventLoopGroup-3-6] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 08:26:38 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 08:26:38 [nioEventLoopGroup-3-5] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 08:26:45 [nioEventLoopGroup-3-8] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/promo-codes
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promo-codes
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/promo-codes
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - Creating new promocode
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.service.PromoCodeServiceImpl - Создание нового промокода: вым
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при создании промокода
org.postgresql.util.PSQLException: ERROR: column "created_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 132
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.insert(PromoCodeDaoImpl.java:178)
	at server.service.PromoCodeServiceImpl.createPromoCode(PromoCodeServiceImpl.java:96)
	at server.handler.PromoCodeHandler.handleCreatePromoCode(PromoCodeHandler.java:199)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:79)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] ERROR server.service.PromoCodeServiceImpl - Не удалось создать промокод в БД: вым
2025-05-23 08:27:10 [nioEventLoopGroup-3-9] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 08:27:36 [nioEventLoopGroup-3-10] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promo-codes/2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promo-codes/2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: PUT /api/promo-codes/2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.handler.PromoCodeHandler - Updating promocode with id: 2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.service.PromoCodeServiceImpl - Обновление промокода с ID: 2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при обновлении промокода с ID: 2
org.postgresql.util.PSQLException: ERROR: column "created_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 129
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.update(PromoCodeDaoImpl.java:231)
	at server.service.PromoCodeServiceImpl.updatePromoCode(PromoCodeServiceImpl.java:130)
	at server.handler.PromoCodeHandler.handleUpdatePromoCode(PromoCodeHandler.java:221)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:94)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] WARN  server.service.PromoCodeServiceImpl - Не удалось обновить промокод с ID: 2
2025-05-23 08:27:52 [nioEventLoopGroup-3-11] DEBUG server.handler.PromoCodeHandler - Sent error response: 404 Not Found, {"success":false,"data":null,"errorMessage":"Promocode not found","errorCode":"ERROR"}
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promotions/4
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promotions/4
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions/4
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.handler.PromotionHandler - Обновление акции с ID: 4
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.service.PromotionServiceImpl - Получение акции по ID: 4
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.service.PromotionServiceImpl - Обновление акции с ID 4: фвафв1
2025-05-23 08:28:05 [nioEventLoopGroup-3-12] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 08:28:05 [nioEventLoopGroup-3-13] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 10:14:20 [LoyaltySystemPool housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Thread starvation or clock leap detected (housekeeper delta=1h13m49s493ms977µs200ns).
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 10:44:27 [nioEventLoopGroup-3-14] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 10:44:29 [nioEventLoopGroup-3-15] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 10:44:29 [nioEventLoopGroup-3-16] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:32 [nioEventLoopGroup-3-2] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 10:44:32 [nioEventLoopGroup-3-1] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 10:44:32 [nioEventLoopGroup-3-3] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 10:44:36 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: PUT /api/promo-codes/2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: PUT /api/promo-codes/2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes/2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: PUT /api/promo-codes/2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Updating promocode with id: 2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.service.PromoCodeServiceImpl - Обновление промокода с ID: 2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.service.PromoCodeServiceImpl - Получение промокода по ID: 2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] ERROR server.db.dao.PromoCodeDaoImpl - Ошибка при обновлении промокода с ID: 2
org.postgresql.util.PSQLException: ERROR: column "created_by" is of type integer but expression is of type character varying
  Hint: You will need to rewrite or cast the expression.
  Position: 129
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2712)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2400)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:367)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:498)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:415)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:190)
	at org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:152)
	at com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at server.db.dao.PromoCodeDaoImpl.update(PromoCodeDaoImpl.java:231)
	at server.service.PromoCodeServiceImpl.updatePromoCode(PromoCodeServiceImpl.java:130)
	at server.handler.PromoCodeHandler.handleUpdatePromoCode(PromoCodeHandler.java:221)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:94)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] WARN  server.service.PromoCodeServiceImpl - Не удалось обновить промокод с ID: 2
2025-05-23 10:44:46 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Sent error response: 404 Not Found, {"success":false,"data":null,"errorMessage":"Promocode not found","errorCode":"ERROR"}
2025-05-23 11:32:57 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 11:32:57 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 11:33:00 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 11:33:00 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 11:33:00 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 11:33:02 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 11:33:04 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 11:35:01 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 11:35:01 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 11:35:03 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@4d910fd6
2025-05-23 11:35:03 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 11:35:03 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 11:35:03 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 11:35:03 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 11:35:47 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 11:35:48 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 11:35:48 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 11:35:48 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 11:35:48 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 11:35:48 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:35:48 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 11:35:49 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 11:35:49 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 11:36:23 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 11:36:23 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 11:36:23 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 11:48:02 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 11:48:02 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 11:48:02 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@4d910fd6
2025-05-23 11:48:02 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 11:48:02 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 11:48:03 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 11:48:03 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 11:49:00 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 11:49:01 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 11:49:02 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 11:49:02 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 11:49:03 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 11:49:03 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 11:49:03 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 11:49:03 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 11:49:06 [nioEventLoopGroup-3-4] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/users
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/users
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Handling GET all users request
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Getting all users from service
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.service.UserServiceImpl - Получение всех пользователей
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Retrieved 9 users from database
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Sending response with 9 users
2025-05-23 11:49:09 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Sent success response
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 11:49:11 [nioEventLoopGroup-3-6] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 11:49:11 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 11:49:11 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 12:13:10 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 12:13:10 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 12:13:13 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 12:13:13 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 12:13:13 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 12:13:13 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 12:13:17 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 12:14:31 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 12:14:33 [nioEventLoopGroup-3-3] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 12:14:33 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.SettingsHandler - SettingsHandler processing: GET /api/statistics/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.handler.SettingsHandler - SettingsHandler processing: GET /api/promo-codes
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 12:14:39 [nioEventLoopGroup-3-4] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 12:14:39 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.service.SettingsServiceImpl - Запрос настройки по ключу из базы данных: backup.path
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] INFO  server.service.BackupServiceImpl - Резервные копии не найдены в директории: C:\Users\Korne/backups
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.handler.SettingsHandler - SettingsHandler processing: GET /api/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 12:14:39 [nioEventLoopGroup-3-6] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 14:01:09 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 14:01:09 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 14:01:10 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@2cd2a21f
2025-05-23 14:01:10 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 14:01:10 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 14:01:11 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 14:01:11 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/auth
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Обработка запроса на аутентификацию
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Запрос на аутентификацию пользователя: admin
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Попытка аутентификации пользователя: admin
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Всего пользователей в базе данных: 9
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin, role=ADMIN, id=1
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff2, role=STAFF, id=4
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=staff1, role=STAFF, id=3
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfй, role=CLIENT, id=11
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=afsdas, role=CLIENT, id=8
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=sadfafsd, role=CLIENT, id=9
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=admin1, role=CLIENT, id=7
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client2, role=CLIENT, id=6
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.service.UserServiceImpl - Пользователь в БД: login=client1, role=CLIENT, id=5
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - Executing SQL for user lookup: SELECT u.id, u.login, u.password, u.role_id, r.name as role_name, u.full_name, u.email, u.phone, u.registration_date FROM users u JOIN roles r ON u.role_id = r.id WHERE LOWER(u.login) = LOWER(?)
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.db.dao.UserDaoImpl - User found: login=admin, id=1
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] INFO  server.service.UserServiceImpl - Пользователь успешно аутентифицирован: admin
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] DEBUG server.handler.AuthHandler - Sent success response
2025-05-23 14:01:58 [nioEventLoopGroup-3-1] INFO  server.handler.AuthHandler - Пользователь admin успешно аутентифицирован
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/cards
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Processing request: GET /api/cards
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Handling request to get all cards
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.service.CardServiceImpl - Получение всех карт лояльности
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Retrieved 10 cards from database
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sending success response with 10 cards
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Sent success response
2025-05-23 14:01:59 [nioEventLoopGroup-3-2] DEBUG server.handler.CardHandler - Successfully sent 10 cards to client
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/users
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/users
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Handling GET all users request
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Getting all users from service
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.service.UserServiceImpl - Получение всех пользователей
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Retrieved 9 users from database
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Sending response with 9 users
2025-05-23 14:02:02 [nioEventLoopGroup-3-3] DEBUG server.handler.UserHandler - Sent success response
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] DEBUG server.handler.UserHandler - Not a user API request: /api/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Запрос всех акций
2025-05-23 14:02:03 [nioEventLoopGroup-3-4] DEBUG server.handler.PromotionHandler - Sent success response with charset: UTF-8
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/statistics/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/statistics/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.handler.UserHandler - Not a user API request: /api/statistics/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/statistics/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/statistics/promotions
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Getting promotions statistics
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.service.PromotionServiceImpl - Получение всех акций
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/promo-codes
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/promo-codes
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/promo-codes
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Getting all promocodes
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] DEBUG server.service.PromoCodeServiceImpl - Получение всех промокодов
2025-05-23 14:02:03 [nioEventLoopGroup-3-6] DEBUG server.handler.StatisticsHandler - Sent success response
2025-05-23 14:02:03 [nioEventLoopGroup-3-5] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] DEBUG server.handler.HttpServerHandler - Получен запрос: POST /api/promo-codes
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - UserHandler processing request: POST /api/promo-codes
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] DEBUG server.handler.UserHandler - Not a user API request: /api/promo-codes
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: POST /api/promo-codes
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Creating new promocode
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] DEBUG server.service.PromoCodeServiceImpl - Создание нового промокода: ewr234
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] ERROR server.service.PromoCodeServiceImpl - Ошибка при создании промокода в БД: ewr234
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because the return value of "common.model.PromoCode.getPromotionId()" is null
	at server.db.dao.PromoCodeDaoImpl.insert(PromoCodeDaoImpl.java:158)
	at server.service.PromoCodeServiceImpl.createPromoCode(PromoCodeServiceImpl.java:96)
	at server.handler.PromoCodeHandler.handleCreatePromoCode(PromoCodeHandler.java:199)
	at server.handler.PromoCodeHandler.handle(PromoCodeHandler.java:79)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:53)
	at server.handler.HttpServerHandler.channelRead0(HttpServerHandler.java:16)
	at io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)
	at io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)
	at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)
	at io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.handler.timeout.IdleStateHandler.channelRead(IdleStateHandler.java:286)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-05-23 14:02:23 [nioEventLoopGroup-3-7] DEBUG server.handler.PromoCodeHandler - Sent success response
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка наличия обязательных настроек
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] INFO  server.service.SettingsServiceImpl - Проверка обязательных настроек завершена
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] INFO  server.handler.SettingsHandler - SettingsHandler initialized
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] INFO  server.handler.UserHandler - UserHandler initialized
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.HttpServerHandler - Получен запрос: GET /api/api/reports/points?from=2025-04-23&to=2025-05-23
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - UserHandler processing request: GET /api/api/reports/points?from=2025-04-23&to=2025-05-23
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.UserHandler - Not a user API request: /api/api/reports/points?from=2025-04-23&to=2025-05-23
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.PromoCodeHandler - PromoCodeHandler processing: GET /api/api/reports/points?from=2025-04-23&to=2025-05-23
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.StatisticsHandler - StatisticsHandler processing: GET /api/api/reports/points?from=2025-04-23&to=2025-05-23
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.ReportHandler - ReportHandler processing: GET /api/api/reports/points?from=2025-04-23&to=2025-05-23
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.ReportHandler - Generating points report from 2025-04-23 to 2025-05-23
2025-05-23 14:02:31 [nioEventLoopGroup-3-8] DEBUG server.handler.ReportHandler - Sent success response
2025-05-23 14:08:22 [main] INFO  server.ServerMain - Инициализация базы данных...
2025-05-23 14:08:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Starting...
2025-05-23 14:08:22 [main] INFO  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Added connection org.postgresql.jdbc.PgConnection@4d910fd6
2025-05-23 14:08:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - LoyaltySystemPool - Start completed.
2025-05-23 14:08:22 [main] INFO  server.db.DatabaseConfig - База данных успешно инициализирована
2025-05-23 14:08:22 [main] INFO  server.ServerMain - Запуск HTTP сервера на порту 8090...
2025-05-23 14:08:22 [main] INFO  server.ServerMain - Сервер запущен. Порт: 8090
2025-05-23 14:37:29 [LoyaltySystemPool housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Thread starvation or clock leap detected (housekeeper delta=8m6s154ms783µs700ns).
2025-05-23 14:59:40 [LoyaltySystemPool housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Thread starvation or clock leap detected (housekeeper delta=7m10s334ms791µs).
2025-05-23 17:19:09 [LoyaltySystemPool housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Thread starvation or clock leap detected (housekeeper delta=40m57s740ms60µs).
2025-05-23 17:49:49 [LoyaltySystemPool housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Thread starvation or clock leap detected (housekeeper delta=4m9s68ms449µs100ns).
2025-05-23 18:47:59 [LoyaltySystemPool housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Thread starvation or clock leap detected (housekeeper delta=29m40s78ms449µs500ns).
2025-05-23 22:19:27 [LoyaltySystemPool housekeeper] WARN  com.zaxxer.hikari.pool.HikariPool - LoyaltySystemPool - Thread starvation or clock leap detected (housekeeper delta=3h16m3s6ms917µs500ns).
